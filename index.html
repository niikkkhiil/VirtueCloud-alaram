<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alarm Manager</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 8px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #333; margin-bottom: 30px; }
        .alarm-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
        .alarm-item:last-child { border-bottom: none; }
        .alarm-name { font-size: 16px; color: #555; }
        .switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #4CAF50; }
        input:checked + .slider:before { transform: translateX(26px); }
        .loading { text-align: center; padding: 20px; color: #999; }
        .error { color: #f44336; padding: 20px; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Alarm Manager</h1>
        <div id="alarms-container">
            <div class="loading">Loading alarms...</div>
        </div>
    </div>

    <script>
        const API_URL = 'YOUR_API_GATEWAY_URL'; // Update with your API Gateway URL

        async function loadAlarms() {
            try {
                const response = await fetch(`${API_URL}/alarms`);
                const data = await response.json();
                renderAlarms(data.alarms);
            } catch (error) {
                document.getElementById('alarms-container').innerHTML = 
                    '<div class="error">Failed to load alarms</div>';
            }
        }

        function renderAlarms(alarms) {
            const container = document.getElementById('alarms-container');
            if (alarms.length === 0) {
                container.innerHTML = '<div class="loading">No alarms configured</div>';
                return;
            }
            
            container.innerHTML = alarms.map(alarm => `
                <div class="alarm-item">
                    <span class="alarm-name">${alarm.name}</span>
                    <label class="switch">
                        <input type="checkbox" ${alarm.enabled ? 'checked' : ''} 
                               onchange="toggleAlarm('${alarm.name}', this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
            `).join('');
        }

        async function toggleAlarm(functionName, enabled) {
            try {
                await fetch(`${API_URL}/alarms/toggle`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ function_name: functionName, enabled })
                });
            } catch (error) {
                alert('Failed to toggle alarm');
                loadAlarms();
            }
        }

        loadAlarms();
    </script>
</body>
</html>
